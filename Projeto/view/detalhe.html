<!DOCTYPE html>
<html>
    <head>
        <title>Comida saudável</title>
        <meta charset="iso-8859-2" /> 
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.1/jquery.validate.min.js"></script>
        <script src="detalhe.js"></script>

        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css"> 
        <style type="text/css">
            form > div > label {
                width: 140px; margin-left: 20px; text-align: right
            }
            #detalhe {
                margin-left: 20px;
            }
            section > div > label {
                width: 140px; text-align: right
            }
            form > div > input[type=button] { margin-left: 160px}
            .error{
                color: red;
                margin-left: 5px
            }
            label.error{
                display:inline
            }
        </style>
    </head>
    <body>
        <div class="jumbotron">
            <h1><span class="fa fa-lock"></span> Administração</h1>
            <a href="/auth/logout" >Logout</a>
        </div>

        <section style="margin-left: 50px">
            <a href="/">Voltar</a>
        </section>

        <section id='resultado' class="alert"></section>

        <section id='criar_marmita' style="float:left;margin-right: 50px;">
            <form id='formCriar'>
                <div class="row">
                    <label for="nome">Nome</label>
                    <input id='nome' name='nome' type="text" required/>
                </div>
                <div class="row">
                    <label for="descricao">Descrição</label>
                    <input id='descricao' name='descricao' type="text" required/>
                </div>
                <div class="row">
                    <label>Preço</label>
                    <input id='preco' name='preco' type="number" required/>
                </div>                
                <div class="row">
                    <label>Ingredientes</label>
                    <textarea id='ingredientes' name='ingredientes' rows="5" maxlength="2000" required></textarea>
                </div>                
                <div class="row">
                    <label>Quantidade</label>
                    <input id='quantidade' name='quantidade' type="number" required/>
                </div>                
                <div class="row">
                    <label>Url imagem</label>
                    <input id='url' name='url' type="url" width="200px" required/>
                </div>
                <div class="row">
                    <label>Percentoal desconto</label>
                    <input id='porcentagem' name='porcentagem' type="number" min="0" max="100" />
                </div>
                <div class="row">
                    <input type="submit" name="enviar" value="criar marmita" class="btn btn-primary"/>
                </div>                
            </form>
        </section>

        <section id='detalhe'>
            <form id="formAtualizar" >
                <div class="row">
                    <label>Nome</label>
                    <input id='nomedetalhe' name='nomedetalhe' type="text" required/>
                </div>
                <div class="row">
                    <label>Descrição</label>
                    <input id='descricaodetalhe' name='descricaodetalhe' type="text" required/>
                </div>
                <div class="row">
                    <label>Preço</label>
                    <input id='precodetalhe' name='precodetalhe' type="number" inputmode="numeric" required/>
                </div>
                <div class="row">
                        <label>Preço com desconto</label>
                        <input id='precodescontodetalhe' name='precodescontodetalhe' type="text" readonly/>
                    </div>
                <div class="row">
                    <label>Ingredientes</label>
                    <textarea id='ingredientesdetalhe' name='ingredientesdetalhe' rows="5" maxlength="2000" required></textarea>
                </div>                
                <div class="row">
                    <label>Quantidade</label>
                    <input id='quantidadedetalhe' name='quantidadedetalhe' type="text" required/>
                </div>
                <div class="row">
                    <label>Imagem</label>
                    <input type="text" id="urldetalhe" name="urldetalhe" required/>
                    <img src="#" id='urlimgdetalhe' name='urlimgdetalhe' alt="não informada"/>
                </div>
                <div class="row">
                    <label>Percentoal desconto</label>
                    <input id='porcentagemdetalhe' name='porcentagemdetalhe' type="number" min="0" max="100"/>
                </div>
                <div class="row">
                    <input type="submit" name="atualizar" value="Atualizar" class="btn btn-primary"/>
                    <input type="button" name="excluir" value="Excluir" class="btn btn-primary"/>
                    <input type="hidden" id="codigo" name="codigo">
                </div>
            </form>
        </section>

        <script>
            $.support.cors = true;
            
            document.getElementsByName('enviar')[0].addEventListener('click', sendit);
            document.getElementsByName('atualizar')[0].addEventListener('click', atualizar);
            document.getElementsByName('excluir')[0].addEventListener('click', excluir);

            var regExp = new RegExp('criar', 'i');
            if (regExp.test(document.baseURI)){
                $('#criar_marmita').show();
                $('#porcentagem').val(0);
                $('#detalhe').hide();
            }else{                
                $('#codigo').val(document.location.search.substr(4, document.location.search.length-4));
                $('#criar_marmita').hide();
                detalhe();
                if ($('#porcentagem').val() === ""){
                    $('#porcentagem').val(0);
                }
            }
        </script>
    </body>
    